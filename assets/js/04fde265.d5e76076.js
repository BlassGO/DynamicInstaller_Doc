"use strict";(self.webpackChunkdynamic_installer_doc=self.webpackChunkdynamic_installer_doc||[]).push([[9311],{8142:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"get-plugins/boot-patch","title":"\ud83d\udcc0 Boot Patch","description":"Plugin for unpacking / packing boot.img.","source":"@site/docs/get-plugins/boot-patch.mdx","sourceDirName":"get-plugins","slug":"/get-plugins/boot-patch","permalink":"/DynamicInstaller_Doc/docs/get-plugins/boot-patch","draft":false,"unlisted":false,"editUrl":"https://github.com/BlassGO/DynamicInstaller_Doc/edit/main/docs/get-plugins/boot-patch.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"id":"boot-patch","title":"\ud83d\udcc0 Boot Patch","description":"Plugin for unpacking / packing boot.img."},"sidebar":"tutorialSidebar","previous":{"title":"\ud83e\udde9 Plugins","permalink":"/DynamicInstaller_Doc/docs/category/-plugins"},"next":{"title":"\ud83d\uddbc\ufe0f Image Magick","permalink":"/DynamicInstaller_Doc/docs/get-plugins/imagemagick"}}');var r=i(4848),o=i(8453),s=i(8093);const c={sidebar_position:1,id:"boot-patch",title:"\ud83d\udcc0 Boot Patch",description:"Plugin for unpacking / packing boot.img."},d="\ud83d\udcc0 Boot Patch v1.0.0",l={},a=[{value:"Installation",id:"installation",level:2},{value:"unpack_boot",id:"unpack_boot",level:2},{value:"repack_boot",id:"repack_boot",level:2},{value:"update_ramdisk",id:"update_ramdisk",level:2},{value:"update_kernel",id:"update_kernel",level:2},{value:"patch_cmdline",id:"patch_cmdline",level:2},{value:"remove_cmdline",id:"remove_cmdline",level:2},{value:"flash_image",id:"flash_image",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsxs)(n.h1,{id:"-boot-patch-v100",children:["\ud83d\udcc0 Boot Patch ",(0,r.jsx)(s.A,{title:"Version",children:"v1.0.0"})]})}),"\n",(0,r.jsxs)(n.p,{children:["Allows unpacking and packing the ",(0,r.jsx)(n.code,{children:"boot.img"})," or ",(0,r.jsx)(n.code,{children:"recovery.img"})," of most Android devices."]}),"\n",(0,r.jsx)(n.admonition,{title:"Credits",type:"info",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/BlassGO",children:(0,r.jsx)(n.strong,{children:"BlassGO"})}),": Developer of this plugin."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/topjohnwu",children:(0,r.jsx)(n.strong,{children:"topjohnwu"})}),": For his amazing tools for editing boot.img in his ",(0,r.jsx)(n.a,{href:"https://github.com/topjohnwu/Magisk",children:"Magisk"})," project."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/osm0sis",children:(0,r.jsx)(n.strong,{children:"osm0sis"})}),": For enhancing the patching logic in his ",(0,r.jsx)(n.a,{href:"https://github.com/osm0sis/AnyKernel3",children:"AnyKernel"})," project."]}),"\n"]})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["You can design your own plugins. Check ",(0,r.jsx)(n.a,{href:"/DynamicInstaller_Doc/docs/environment/modules",children:"this"}),"."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Download the plugin ",(0,r.jsx)(n.a,{href:"https://www.mediafire.com/file/xnm2xsxhzp29ydk/boot-patch/file",children:"here"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Add ",(0,r.jsx)(n.code,{children:"boot-patch"})," file in your ",(0,r.jsx)(n.code,{children:"META-INF/addons"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Import it:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'import_module "$addons/boot-patch"\n'})}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Enjoy your new functions!"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"unpack_boot",children:"unpack_boot"}),"\n",(0,r.jsx)(n.p,{children:"Unpacks an existing IMG/Partition."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Argument"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"IMG/Partition"})}),(0,r.jsx)(n.td,{children:"Path to the IMG file or partition to extract"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"FOLDER"})}),(0,r.jsx)(n.td,{children:"Directory where the extracted contents will be saved"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NUMBER"})}),(0,r.jsxs)(n.td,{children:["Optional: Set to ",(0,r.jsx)(n.code,{children:"1"})," to skip unpacking the ramdisk"]})]})]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Unpack some existing IMG\r\nunpack_boot "$TMP/boot.img" "$TMP/first_boot"\r\n\r\n# Unpack from some Partition\r\nunpack_boot $(find_block boot) "$TMP/second_boot"\r\n\r\n# Unpack without unpacking the Ramdisk\r\nunpack_boot $(find_block boot) "$TMP/second_boot" 1\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.p,{children:"You can check if there were any problems during unpacking:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'if unpack_boot $(find_block boot) "$TMP/first_boot"; then\r\n  ui_print "Success"\r\nelse\r\n  abort "Some error"\r\nfi\n'})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"repack_boot",children:"repack_boot"}),"\n",(0,r.jsxs)(n.p,{children:["Rebuilds the IMG unpacked by ",(0,r.jsx)(n.a,{href:"#unpack_boot",children:(0,r.jsx)(n.code,{children:"unpack_boot"})}),"."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Argument"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"FOLDER"})}),(0,r.jsx)(n.td,{children:"Directory containing the unpacked contents"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"OUTPUT"})}),(0,r.jsx)(n.td,{children:"Path to save the rebuilt IMG or partition to write to"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"OPTION"})}),(0,r.jsxs)(n.td,{children:["Optional: Set to ",(0,r.jsx)(n.code,{children:"recovery"})," to use AVB1 signing for recovery images"]})]})]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Repack some unpacked IMG\r\nrepack_boot "$TMP/first_boot" "$TMP/result.img"\r\n\r\n# Repack and send it to some Partition\r\nrepack_boot "$TMP/second_boot" $(find_block boot)\r\n\r\n# Repack some unpacked Recovery image\r\nrepack_boot "$TMP/second_boot" $(find_block recovery) recovery\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Automatic Behaviors:"})}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"Magisk"})," is detected in the original boot.img, a restore will be attempted."]}),"\n",(0,r.jsxs)(n.li,{children:["If the restore fails (for example, due to complete Ramdisk replacement), ",(0,r.jsx)(n.code,{children:"Magisk"})," will be completely removed."]}),"\n"]})]}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsxs)(n.p,{children:["You can check if the resulting IMG lost ",(0,r.jsx)(n.code,{children:"Magisk"}),". Verification of other ROOT methods is not supported."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'repack_boot "$TMP/first_boot" $(find_block boot)\r\nresult=$?\r\n\r\nif is_equal $result 0; then\r\n   ui_print "No error and Magisk ensured"\r\nelif is_equal $result 1; then\r\n   ui_print "Some fatal problem! and no changes were made"\r\nelif is_equal $result 2; then\r\n   ui_print "No error but Magisk is not present"\r\nfi\n'})})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"update_ramdisk",children:"update_ramdisk"}),"\n",(0,r.jsx)(n.p,{children:"Updates the ramdisk of an existing IMG or partition."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Argument"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NEW RAMDISK"})}),(0,r.jsx)(n.td,{children:"Path to the new ramdisk file"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"IMG/Partition"})}),(0,r.jsx)(n.td,{children:"Path to the IMG file or partition to update"})]})]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Update the Ramdisk in some existing IMG\r\nupdate_ramdisk "$TMP/new_ramdisk.cpio" "$TMP/boot.img"\r\n\r\n# Update the Ramdisk in some Partition\r\nupdate_ramdisk "$TMP/new_ramdisk.cpio" $(find_block boot)\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["You can save the error code to know if the IMG lost Magisk. Check ",(0,r.jsx)(n.a,{href:"#repack_boot",children:"repack_boot"}),"."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"update_kernel",children:"update_kernel"}),"\n",(0,r.jsx)(n.p,{children:"Updates the kernel of an existing IMG or partition."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Argument"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"NEW KERNEL"})}),(0,r.jsx)(n.td,{children:"Path to the new kernel file"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"IMG/Partition"})}),(0,r.jsx)(n.td,{children:"Path to the IMG file or partition to update"})]})]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Update the Kernel in some existing IMG\r\nupdate_kernel "$TMP/new_kernel" "$TMP/boot.img"\r\n\r\n# Update the Kernel in some Partition\r\nupdate_kernel "$TMP/new_kernel" $(find_block boot)\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["You can save the error code to know if the IMG lost Magisk. Check ",(0,r.jsx)(n.a,{href:"#repack_boot",children:"repack_boot"}),"."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"patch_cmdline",children:"patch_cmdline"}),"\n",(0,r.jsxs)(n.p,{children:["Patches properties of the ",(0,r.jsx)(n.code,{children:"cmdline"})," of an IMG unpacked by ",(0,r.jsx)(n.a,{href:"#unpack_boot",children:(0,r.jsx)(n.code,{children:"unpack_boot"})}),"."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Argument"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"PROPERTY"})}),(0,r.jsx)(n.td,{children:"Property to add or replace (Multiple allowed)"})]})})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# It is necessary to be in the directory\r\ncd "$TMP/first_boot"\r\n\r\npatch_cmdline androidboot.selinux=permissive\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"Automatically replaces or adds props (if you patch the same prop twice, it won\u2019t repeat)."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"remove_cmdline",children:"remove_cmdline"}),"\n",(0,r.jsxs)(n.p,{children:["Removes properties of the ",(0,r.jsx)(n.code,{children:"cmdline"})," of an IMG unpacked by ",(0,r.jsx)(n.a,{href:"#unpack_boot",children:(0,r.jsx)(n.code,{children:"unpack_boot"})}),"."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Argument"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"PROPERTY"})}),(0,r.jsx)(n.td,{children:"Property to remove (Multiple allowed)"})]})})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# It is necessary to be in the directory\r\ncd "$TMP/first_boot"\r\n\r\nremove_cmdline skip_override\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"flash_image",children:"flash_image"}),"\n",(0,r.jsx)(n.p,{children:"Installs an IMG to a partition or saves it to a file."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Argument"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"IMG"})}),(0,r.jsx)(n.td,{children:"Path to the IMG file to install"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"OUTPUT"})}),(0,r.jsx)(n.td,{children:"Partition to write to or file to save"})]})]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'flash_image "$TMP/boot.img" $(find_block boot)\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["This function is provisional for this plugin, it is not strictly necessary to use it. ",(0,r.jsx)(n.strong,{children:"DI"})," already provides specific functions to do the same."]})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8093:(e,n,i)=>{i.d(n,{A:()=>s});i(6540);var t=i(8532),r=i(6289),o=i(4848);const s=function(e){let{type:n,children:i,title:s}=e;const{isDarkTheme:c}=(0,t.G)(),d={default:{backgroundColor:"#f0f0f0",color:"#333"},addon:{backgroundColor:"#e1f5fe",color:"#0277bd"},zip:{backgroundColor:"#fce4ec",color:"#ad1457"}},l={default:{backgroundColor:"#424242",color:"#e0e0e0"},addon:{backgroundColor:"#4a6572",color:"#e0f7fa"},zip:{backgroundColor:"#6a1b9a",color:"#fce4ec"}},a=c?l[n]||l.default:d[n]||d.default,h=s||`This action supports the ${i} extension`;return"addon"===n||"zip"===n?(0,o.jsx)(r.A,{to:"/docs/environment/extensions-logic",children:(0,o.jsx)("span",{style:{...a,padding:"2px 6px",borderRadius:"4px",fontSize:"0.8em",margin:"0 4px",cursor:"pointer"},title:h,children:i})}):(0,o.jsx)("span",{style:{...a,padding:"2px 6px",borderRadius:"4px",fontSize:"0.8em",margin:"0 4px",cursor:"help"},title:h,children:i})}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var t=i(6540);const r={},o=t.createContext(r);function s(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);